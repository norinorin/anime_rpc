name: Build artifacts

on:
  push:
    branches: [ main ]

jobs:
    build:
        runs-on: windows-latest

        steps:
          - name: Create executable
            uses: sayyid5416/pyinstaller@v1
            with:
              python_ver: '3.10'
              spec: 'anime_rpc/__main__.py'
              requirements: 'requirements.txt'
              options: --onefile, --name anime_rpc
              clean_checkout: false
          - name: Create release
            id: create_release
            uses: ncipollo/release-action@v1
            with:
                tag: latest
                allowUpdates: true
                artifacts: "./dist/anime_rpc.exe"
                replacesArtifacts: true